!function e(t,i,s){function n(o,r){if(!i[o]){if(!t[o]){var u="function"==typeof require&&require;if(!r&&u)return u(o,!0);if(a)return a(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[o]={exports:{}};t[o][0].call(c.exports,function(e){var i=t[o][1][e];return n(i?i:e)},c,c.exports,e,t,i,s)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(e){"use strict";var t=function(e){return e&&e.__esModule?e["default"]:e},i=(t(e("./rAF")),t(e("./wavepad")));window.addEventListener("DOMContentLoaded",function(){var e=new i("wave-pd1");e.init()})},{"./rAF":2,"./wavepad":3}],2:[function(e,t){"use strict";var i=function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var i=(new Date).getTime(),s=Math.max(0,16-(i-e)),n=window.setTimeout(function(){t(i+s)},s);return e=i+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();t.exports=i},{}],3:[function(e,t){"use strict";var i=function(e,t,i){t&&Object.defineProperties(e,t),i&&Object.defineProperties(e.prototype,i)},s=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(t,i){if(s(this,e),this.options={waveform:"square",filter:"lowpass",delay:.5,feedback:.4,barColor:"#1d1c25"},"object"==typeof i)for(var n in i)i.hasOwnProperty(n)&&(this.options[n]=i[n]);if(this.source=null,this.nodes={},this.myAudioContext=null,this.myAudioAnalyser=null,window.AudioContext=window.AudioContext||window.webkitAudioContext,!("AudioContext"in window))throw new Error("wavepad.js: browser does not support Web Audio API");if(this.myAudioContext=new AudioContext,"string"!=typeof t&&"object"!=typeof t)throw new Error("wavepad.js: first argument must be a valid DOM identifier");this.synth="object"==typeof t?t:document.getElementById(t),this.surface=this.synth.querySelector(".surface"),this.finger=this.synth.querySelector(".finger"),this.waveform=this.synth.querySelector("#waveform"),this.filter=this.synth.querySelector("#filter-type"),this.powerToggle=this.synth.querySelector("#power"),this.delayTimeInput=this.synth.querySelector("#delay"),this.feedbackGainInput=this.synth.querySelector("#feedback"),this.delayTimeOutput=this.synth.querySelector("#delay-output"),this.feedbackGainOutput=this.synth.querySelector("#feedback-output"),this.canvas=this.synth.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.hasTouch=!1,this.isSmallViewport=!1,this.isPlaying=!1}return i(e,null,{init:{value:function(){this.handleResize(),this.startHandler=this.start.bind(this),this.moveHandler=this.move.bind(this),this.stopHandler=this.stop.bind(this),this.delayTimeInput.value=this.options.delay,this.feedbackGainInput.value=this.options.feedback,this.waveform.value=this.options.waveform,this.filter.value=this.options.filter,this.updateOutputs(),this.powerToggle.addEventListener("click",this.togglePower.bind(this)),this.waveform.addEventListener("change",this.setWaveform.bind(this)),this.filter.addEventListener("change",this.filterChange.bind(this)),this.delayTimeInput.addEventListener("input",this.delayChange.bind(this)),this.feedbackGainInput.addEventListener("input",this.feedbackChange.bind(this)),this.nodes.oscVolume=this.myAudioContext.createGain(),this.nodes.filter=this.myAudioContext.createBiquadFilter(),this.nodes.volume=this.myAudioContext.createGain(),this.nodes.delay=this.myAudioContext.createDelay(),this.nodes.feedbackGain=this.myAudioContext.createGain(),this.nodes.compressor=this.myAudioContext.createDynamicsCompressor(),this.myAudioAnalyser=this.myAudioContext.createAnalyser(),this.myAudioAnalyser.smoothingTimeConstant=.85,this.animateSpectrum(),this.surface.addEventListener("touchmove",function(e){e.preventDefault()})},writable:!0,configurable:!0},handleResize:{value:function(){var e=this,t=window.matchMedia("(max-width: 512px)");this.isSmallViewport=t.matches?!0:!1,this.setCanvasSize(),t.addListener(function(t){e.isSmallViewport=t.matches?!0:!1,e.setCanvasSize()})},writable:!0,configurable:!0},routeSounds:{value:function(){this.source=this.myAudioContext.createOscillator(),this.setWaveform(this.waveform),this.filterChange(this.filter),this.nodes.feedbackGain.gain.value=this.options.feedback,this.nodes.delay.delayTime.value=this.options.delay,this.nodes.volume.gain.value=.2,this.nodes.oscVolume.gain.value=0,this.source.connect(this.nodes.oscVolume),this.nodes.oscVolume.connect(this.nodes.filter),this.nodes.filter.connect(this.nodes.compressor),this.nodes.filter.connect(this.nodes.delay),this.nodes.delay.connect(this.nodes.feedbackGain),this.nodes.delay.connect(this.nodes.compressor),this.nodes.feedbackGain.connect(this.nodes.delay),this.nodes.compressor.connect(this.nodes.volume),this.nodes.volume.connect(this.myAudioAnalyser),this.myAudioAnalyser.connect(this.myAudioContext.destination)},writable:!0,configurable:!0},startOsc:{value:function(){this.source.start(0),this.isPlaying=!0},writable:!0,configurable:!0},stopOsc:{value:function(){this.source.stop(0),this.isPlaying=!1},writable:!0,configurable:!0},bindSurfaceEvents:{value:function(){this.surface.addEventListener("mousedown",this.startHandler),this.surface.addEventListener("touchstart",this.startHandler)},writable:!0,configurable:!0},unbindSurfaceEvents:{value:function(){this.surface.removeEventListener("mousedown",this.startHandler),this.surface.removeEventListener("touchstart",this.startHandler)},writable:!0,configurable:!0},togglePower:{value:function(){this.isPlaying?(this.stopOsc(),this.myAudioAnalyser.disconnect(),this.unbindSurfaceEvents()):(this.routeSounds(),this.startOsc(),this.bindSurfaceEvents()),this.synth.classList.toggle("off")},writable:!0,configurable:!0},start:{value:function(e){var t="touchstart"===e.type?e.touches[0].pageX:e.pageX,i="touchstart"===e.type?e.touches[0].pageY:e.pageY,s=this.isSmallViewport?2:1;if("touchstart"===e.type)this.hasTouch=!0;else if("mousedown"===e.type&&this.hasTouch)return;this.isPlaying||(this.routeSounds(),this.startOsc()),t-=this.surface.offsetLeft,i-=this.surface.offsetTop,this.nodes.oscVolume.gain.value=1,this.source.frequency.value=t*s,this.nodes.filter.frequency.value=this.setFilterFrequency(i),this.finger.style.webkitTransform=this.finger.style.transform="translate3d("+t+"px, "+i+"px, 0)",this.finger.classList.add("active"),this.surface.addEventListener("touchmove",this.moveHandler),this.surface.addEventListener("touchend",this.stopHandler),this.surface.addEventListener("touchcancel",this.stopHandler),this.surface.addEventListener("mousemove",this.moveHandler),this.surface.addEventListener("mouseup",this.stopHandler)},writable:!0,configurable:!0},move:{value:function(e){var t="touchmove"===e.type?e.touches[0].pageX:e.pageX,i="touchmove"===e.type?e.touches[0].pageY:e.pageY;if("mousemove"!==e.type||!this.hasTouch){if(this.isPlaying){var s=this.isSmallViewport?2:1;t-=this.surface.offsetLeft,i-=this.surface.offsetTop,this.source.frequency.value=t*s,this.nodes.filter.frequency.value=this.setFilterFrequency(i)}this.finger.style.webkitTransform=this.finger.style.transform="translate3d("+t+"px, "+i+"px, 0)"}},writable:!0,configurable:!0},stop:{value:function(e){var t="touchend"===e.type?e.changedTouches[0].pageX:e.pageX,i="touchend"===e.type?e.changedTouches[0].pageY:e.pageY;if(this.isPlaying){var s=this.isSmallViewport?2:1;t-=this.surface.offsetLeft,i-=this.surface.offsetTop,this.source.frequency.value=t*s,this.nodes.filter.frequency.value=this.setFilterFrequency(i),this.nodes.oscVolume.gain.value=0}this.finger.classList.remove("active"),this.surface.removeEventListener("mousemove",this.moveHandler),this.surface.removeEventListener("mouseup",this.stopHandler),this.surface.removeEventListener("touchmove",this.moveHandler),this.surface.removeEventListener("touchend",this.stopHandler),this.surface.removeEventListener("touchcancel",this.stopHandler)},writable:!0,configurable:!0},updateOutputs:{value:function(){this.delayTimeOutput.value=Math.round(1e3*this.delayTimeInput.value)+" ms",this.feedbackGainOutput.value=Math.round(10*this.feedbackGainInput.value)},writable:!0,configurable:!0},setWaveform:{value:function(e){this.source.type=e.value||e.target.value},writable:!0,configurable:!0},delayChange:{value:function(e){this.options.delay=e.target.value,this.isPlaying&&(this.stopOsc(),this.nodes.delay.delayTime.value=this.options.delay),this.updateOutputs()},writable:!0,configurable:!0},feedbackChange:{value:function(e){this.options.feedback=e.target.value,this.isPlaying&&(this.stopOsc(),this.nodes.feedbackGain.gain.value=this.options.feedback),this.updateOutputs()},writable:!0,configurable:!0},setFilterFrequency:{value:function(e){var t=40,i=this.myAudioContext.sampleRate/2,s=Math.log(i/t)/Math.LN2,n=Math.pow(2,s*(2/this.surface.clientHeight*(this.surface.clientHeight-e)-1));return i*n},writable:!0,configurable:!0},filterChange:{value:function(e){this.nodes.filter.type=e.value||e.target.value},writable:!0,configurable:!0},animateSpectrum:{value:function(){setTimeout(this.onTick.bind(this),25)},writable:!0,configurable:!0},onTick:{value:function(){this.drawSpectrum(),requestAnimationFrame(this.animateSpectrum.bind(this))},writable:!0,configurable:!0},setCanvasSize:{value:function(){var e=this.isSmallViewport?256:512;this.canvas.width=this.canvas.height=e-10,this.ctx.fillStyle=this.options.barColor},writable:!0,configurable:!0},drawSpectrum:{value:function(){var e=this.isSmallViewport?256:512,t=this.isSmallViewport?10:20,i=Math.round(e/t),s=new Uint8Array(this.myAudioAnalyser.frequencyBinCount);this.myAudioAnalyser.getByteFrequencyData(s),this.ctx.clearRect(0,0,e,e);for(var n=0;i>n;n+=1){var a=s[n],o=this.isSmallViewport?1:2;this.ctx.fillRect(t*n,e,t-1,-a*o)}},writable:!0,configurable:!0}}),e}();t.exports=n},{}]},{},[1]);